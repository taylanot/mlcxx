% MAML Aim -> Intermediate Model
MAML aims to obtain an intermediate model that can generalize well after adaptation to a dataset $\dataset$ observed from a new and unseen task $\task$ drawn from $\prob_\task$ where the number of training points $K$ and the number of iterations $\iter$ is limited.  

% How to obtain the intermediate 
In order to obtain the intermediate model which is parametrized by $\param$ first, a batch of tasks from $\prob_{\task}$ is observed with each having a corresponding dataset $\dataset$. Then, the future gradients with respect to each task are observed and gradient descent is utilized to get possible parameters $\param^\prime$ for each task and a gradient descent iteration is made by collecting all the possible parameters from an observed batch of tasks for the real parameter update. The general procedure for supervised learning problems is given in Algorithm \ref{alg:MAML}. Authors of \cite{finn2017} indicate that by using this procedure the model is kept in a place where one or more gradient updates from a specific task with giving maximum generalization performance on that task.

\begin{algorithm}
  \caption{MAML\cite{finn2017} Algorithm}\label{alg:MAML}
  \KwData{$\prob_{\task}$, $\alpha$, $\beta$}
  \KwResult{Intermediate Model $\model(\param_{meta})$}
  initialize $\param$ randomly; \\
  \While{not done}
  {
    sample a batch of tasks $\task_i$ from $\prob_{\task}$\\
    \ForAll{$\task_i$}
    {
      Obtain future gradients: $\grad{\param}\loss_{\task_i}(\model(\param))$ wrt. $\dataset_K$ \\
      Possible future parameters: $\param_i^\prime = \param_i -\alpha\grad{\param}\loss_{\task_i}(\model(\param))$
    }
    Update: $\param \leftarrow \param- \beta\grad{\param}\sum\loss_{\task_i}(\model(\param_i^\prime))$
  }
\end{algorithm}

\begin{figure}[ht!]
  \centering
  \begin{subfigure}[b]{0.49\textwidth}
    \centering
    \includetikz{\textwidth}{Figures_v1/methods/lin_maml.tikz}
    \caption{Linear Problem}
    \label{fig:lin_maml}
  \end{subfigure}
  \begin{subfigure}[b]{0.49\textwidth}
    \centering
    \includetikz{\textwidth}{Figures_v1/methods/nonlin_maml.tikz}
    \caption{Nonlinear Problem}
    \label{fig:nonlin_maml}
  \end{subfigure}
  \caption{Visualizing the MAML intermediate model. 100 sample tasks drawn from $\prob_\task$ for both linear ($m=0$ and $c=1$) and nonlinear ($c_1=2$ and $c_2=2$) problems shown transparent and intermediate model trained (obtained from MAML algorithm) for 1D cases of the experimentation given with solid dark orange line. The linear and the nonlinear problems are provided in Section \ref{sec:methods}.}
\end{figure}


